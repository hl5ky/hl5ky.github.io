<!DOCType HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#" manifest="cache.manifest">
<head>
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="viewport" content="width=device-width" />
<title>QSO코흐법</title>
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.8/codemirror.css'>
<script>
window.console = window.console || function(t) {};
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.8/codemirror.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.8/mode/xml/xml.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.8/addon/selection/mark-selection.js'></script>
<script type="text/javascript">
/*! hangul-js 2019-12-10 */
!function(){"use strict";var r,d,g,l,t,e,h=["ㄱ",["ㄱ","ㄱ"],"ㄴ","ㄷ",["ㄷ","ㄷ"],"ㄹ","ㅁ","ㅂ",["ㅂ","ㅂ"],"ㅅ",["ㅅ","ㅅ"],"ㅇ","ㅈ",["ㅈ","ㅈ"],"ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],p=["ㅏ","ㅐ","ㅑ",["ㅑ","ㅣ"],"ㅓ","ㅔ","ㅕ",["ㅕ","ㅣ"],"ㅗ",["ㅗ","ㅏ"],["ㅗ","ㅐ"],["ㅗ","ㅣ"],"ㅛ","ㅜ",["ㅜ","ㅓ"],["ㅜ","ㅔ"],["ㅜ","ㅣ"],"ㅠ","ㅡ",["ㅡ","ㅣ"],"ㅣ"],C=["","ㄱ",["ㄱ","ㄱ"],["ㄱ","ㅅ"],"ㄴ",["ㄴ","ㅈ"],["ㄴ","ㅎ"],"ㄷ","ㄹ",["ㄹ","ㄱ"],["ㄹ","ㅁ"],["ㄹ","ㅂ"],["ㄹ","ㅅ"],["ㄹ","ㅌ"],["ㄹ","ㅍ"],["ㄹ","ㅎ"],"ㅁ","ㅂ",["ㅂ","ㅅ"],"ㅅ",["ㅅ","ㅅ"],"ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"],A=44032;function n(n){for(var r=n.length,t={0:0},e=0;e<r;e++)n[e]&&(t[n[e].charCodeAt(0)]=e);return t}function o(n){for(var r,t,e=n.length,o={},i=0;i<e;i++)r=n[i][0].charCodeAt(0),t=n[i][1].charCodeAt(0),void 0===o[r]&&(o[r]={}),o[r][t]=n[i][2].charCodeAt(0);return o}function v(n){return void 0!==r[n]}function y(n){return void 0!==d[n]}function m(n){return void 0!==g[n]}function u(n){return void 0!==l[n]}function j(n){return 44032<=n&&n<=55203}function b(n,r){return!(!e[n]||!e[n][r])&&e[n][r]}function S(n,r){return!(!t[n]||!t[n][r])&&t[n][r]}r=n(["ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄸ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅃ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"]),d=n(["ㄱ","ㄲ","ㄴ","ㄷ","ㄸ","ㄹ","ㅁ","ㅂ","ㅃ","ㅅ","ㅆ","ㅇ","ㅈ","ㅉ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"]),g=n(["ㅏ","ㅐ","ㅑ","ㅒ","ㅓ","ㅔ","ㅕ","ㅖ","ㅗ","ㅘ","ㅙ","ㅚ","ㅛ","ㅜ","ㅝ","ㅞ","ㅟ","ㅠ","ㅡ","ㅢ","ㅣ"]),l=n(["","ㄱ","ㄲ","ㄳ","ㄴ","ㄵ","ㄶ","ㄷ","ㄹ","ㄺ","ㄻ","ㄼ","ㄽ","ㄾ","ㄿ","ㅀ","ㅁ","ㅂ","ㅄ","ㅅ","ㅆ","ㅇ","ㅈ","ㅊ","ㅋ","ㅌ","ㅍ","ㅎ"]),t=o([["ㄱ","ㅅ","ㄳ"],["ㄴ","ㅈ","ㄵ"],["ㄴ","ㅎ","ㄶ"],["ㄹ","ㄱ","ㄺ"],["ㄹ","ㅁ","ㄻ"],["ㄹ","ㅂ","ㄼ"],["ㄹ","ㅅ","ㄽ"],["ㄹ","ㅌ","ㄾ"],["ㄹ","ㅍ","ㄿ"],["ㄹ","ㅎ","ㅀ"],["ㅂ","ㅅ","ㅄ"],["ㄱ","ㄱ","ㄲ"],["ㄷ","ㄷ","ㄸ"],["ㅂ","ㅂ","ㅃ"],["ㅅ","ㅅ","ㅆ"],["ㅈ","ㅈ","ㅉ"]]),e=o([["ㅗ","ㅏ","ㅘ"],["ㅗ","ㅐ","ㅙ"],["ㅗ","ㅣ","ㅚ"],["ㅜ","ㅓ","ㅝ"],["ㅜ","ㅔ","ㅞ"],["ㅜ","ㅣ","ㅟ"],["ㅡ","ㅣ","ㅢ"]]);function w(n,r){if(null===n)throw new Error("Arguments cannot be null");"object"==typeof n&&(n=n.join(""));for(var t,e,o,i,u,f=[],c=n.length,a=0;a<c;a++){var s=[];j(i=n.charCodeAt(a))?(e=((i-=A)-(o=i%28))/28%21,t=parseInt((i-o)/28/21),"object"==typeof h[t]?s=s.concat(h[t]):s.push(h[t]),"object"==typeof p[e]?s=s.concat(p[e]):s.push(p[e]),0<o&&("object"==typeof C[o]?s=s.concat(C[o]):s.push(C[o]))):v(i)?"string"==typeof(u=y(i)?h[d[i]]:C[l[i]])?s.push(u):s=s.concat(u):m(i)?"string"==typeof(u=p[g[i]])?s.push(u):s=s.concat(u):s.push(n.charAt(a)),r?f.push(s):f=f.concat(s)}return f}function i(n){return"string"!=typeof n?"":(n=w(n)).join("")}function f(c){"string"==typeof c&&(c=w(c));var n,r,a=[],t=c.length,e=0,s=-1,h=!1;function o(n){var r,t,e,o,i=0,u="";if(h=!1,!(n<s+1))for(var f=1;;f++){if(1===f){if(m(r=c[s+f].charCodeAt(0)))return s+f+1<=n&&m(t=c[s+f+1].charCodeAt(0))?a.push(String.fromCharCode(b(r,t))):a.push(c[s+f]),void(s=n);if(!y(r))return a.push(c[s+f]),void(s=n);u=c[s+f]}else if(2===f){if(y(t=c[s+f].charCodeAt(0)))return r=S(r,t),u=String.fromCharCode(r),a.push(u),void(s=n);u=String.fromCharCode(28*(21*d[r]+g[t])+A)}else 3===f?(b(t,e=c[s+f].charCodeAt(0))?t=b(t,e):i=e,u=String.fromCharCode(28*(21*d[r]+g[t])+l[i]+A)):4===f?(i=S(i,o=c[s+f].charCodeAt(0))?S(i,o):o,u=String.fromCharCode(28*(21*d[r]+g[t])+l[i]+A)):5===f&&(i=S(i,o=c[s+f].charCodeAt(0)),u=String.fromCharCode(28*(21*d[r]+g[t])+l[i]+A));if(n<=s+f)return a.push(u),void(s=n)}}for(var i=0;i<t;i++)y(n=c[i].charCodeAt(0))||m(n)||u(n)?(0===e?y(n)?e=1:m(n)&&(e=4):1==e?m(n)?e=2:S(r,n)?e=5:o(i-1):2==e?u(n)?e=3:m(n)?b(r,n)||(o(i-1),e=4):(o(i-1),e=1):3==e?u(n)?!h&&S(r,n)?h=!0:(o(i-1),e=1):y(n)?(o(i-1),e=1):m(n)&&(o(i-2),e=2):4==e?m(n)?b(r,n)?(o(i),e=0):o(i-1):(o(i-1),e=1):5==e&&(e=m(n)?(o(i-2),2):(o(i-1),1)),r=n):(o(i-1),o(i),e=0);return o(i-1),a.join("")}function c(n){this.string=n,this.disassembled=w(n).join("")}c.prototype.search=function(n){return w(n).join("").indexOf(this.disassembled)};var a={disassemble:w,d:w,disassembleToString:i,ds:i,assemble:f,a:f,search:function(n,r){var t=w(n).join(""),e=w(r).join("");return t.indexOf(e)},rangeSearch:function(n,r){var t,e=w(n).join(""),o=w(r).join(""),i=w(n,!0),u=new RegExp(o,"gi"),f=[];if(!r.length)return[];for(;t=u.exec(e);)f.push(t.index);return f.map(function(n){return[function(n){for(var r=0,t=0;r<i.length;++r)if(n<(t+=i[r].length))return r}(n),function(n){for(var r=0,t=0;r<i.length;++r)if(t+=i[r].length,n+o.length<=t)return r}(n)]})},Searcher:c,endsWithConsonant:function(n){"object"==typeof n&&(n=n.join(""));var r=n.charCodeAt(n.length-1);if(j(r)){if(0<(r-=A)%28)return!0}else if(v(r))return!0;return!1},endsWith:function(n,r){return w(n).pop()===r},isHangul:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),j(n)},isComplete:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),j(n)},isConsonant:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),v(n)},isVowel:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),m(n)},isCho:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),y(n)},isJong:function(n){return"string"==typeof n&&(n=n.charCodeAt(0)),u(n)},isHangulAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!j(n.charCodeAt(r)))return!1;return!0},isCompleteAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!j(n.charCodeAt(r)))return!1;return!0},isConsonantAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!v(n.charCodeAt(r)))return!1;return!0},isVowelAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!m(n.charCodeAt(r)))return!1;return!0},isChoAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!y(n.charCodeAt(r)))return!1;return!0},isJongAll:function(n){if("string"!=typeof n)return!1;for(var r=0;r<n.length;r++)if(!u(n.charCodeAt(r)))return!1;return!0}};"function"==typeof define&&define.amd?define(function(){return a}):"undefined"!=typeof module?module.exports=a:window.Hangul=a}();
</script>
<style>
body {
    background-color: white ;
    font-family: 'Helvetica', 'sans serif';
    font-size: medium;
	line-height: 1.5;
    min-width: 760px;
    margin: 0 auto;
}
.page {
    width: 90%;
    margin-left: auto;
    margin-right: auto;
    padding: 1em;
}
p {
    padding: 4px;
    background: white;
    color: black;
}
input {
    padding: 4px;
    border: 1px solid lightsalmon;
    transition: box-shadow 0.3s;
    background: lightyellow;
    border-radius: 5px;
    color: black;
    font-family: 'Helvetica', 'sans serif';
    font-size: large;
}

input:focus { 
    border: 1px solid teal;
    box-shadow: 0 0 5px 1px powderblue;
}
button {
    color: black;
    font-family: 'Helvetica', 'sans serif';
    font-size: large;
    font-weight: bold;
    margin-top: 6px;
}
#play {
    color: blue;
}
#stop {
    color: red;
}
#freq { 
    width: 3em;
}
#speed {
    width: 3em;
}
#volume {
    width: 3em;
}
textarea {
    width : 100%;
    height : auto;
    padding: 10px;
    border: 1px solid lightsalmon;
    transition: box-shadow 0.3s;
    background: lightyellow;
    border-radius: 5px;
    color: black;
    font-family: 'Helvetica', 'sans serif';
    font-size: x-large;
    font-weight: bold;
    line-height: 1.5;
}
#counter {
    float: right;
}
.font_medium {
    font-size : medium;
}
.setting {
    line-height: 2;
    margin-top: 0px;    
}
.setting_bold {
    font-weight: 600;
}
.setting_group {
    padding: 4px 0px 4px 10px;
    margin-right: 10px;
    border: 1px dotted teal;
    white-space: nowrap;
}
.setting_group_2 {
    margin-right: 10px;
    white-space: nowrap;
}
.sample_group > button {
    margin-top: 7px;
    margin-bottom: 4px;
}
::selection {
    background-color: rgba(255, 0, 0, 0.5);
}
.hidden_sample {
    display : none;
}

.CodeMirror {
    width : 100%;
    height : 12em;
    padding: 10px;
    border: 1px solid lightsalmon;
    transition: box-shadow 0.3s;
    background: lightyellow;
    border-radius: 5px;
    color: black;
    font-family: 'Helvetica', 'sans serif';
    font-size: x-large;
    font-weight: bold;
    line-height: 1.5;
    margin-top: 20px;
}
.CodeMirror-selected { background-color: rgba(255, 0, 0, 0.5); }
.CodeMirror-focused .CodeMirror-selected { background-color: rgba(255, 0, 0, 0.5); }
.hide_markText { background-color: black; }
.show_markText { background-color: inherit; }

.log_container_ditdah {
    width : 100%;
    height : 12px;
    overflow: hidden;
    padding: 10px;
    border: 1px solid lightsalmon;
    transition: box-shadow 0.3s;
    background: lightyellow;
    border-radius: 5px;
    color: black;
    font-family: 'monospace';
    font-size: small;
    white-space: nowrap;
    margin-top: 0px;
}
#ditdah {
    height:10px;
    float: right;
}
.ditdah_bar {
    background: green;
    height: 10px;
    display: inline-block;
}
.ditdah_gap {
    height: 10px;
    display: inline-block;
}
#keyer_setting {
    display: none;
    line-height: 2;
}
#connect {
    color: blue;
}
#disconnect {
    color: red;
}
#mp3 {
	display: inline-block;
	margin: auto;
	padding-left: 10px;
}
audio {
	height: 1em;
	margin-bottom: -3px;
}
</style>
</head>
<body>
<div class="page">

<p><span style="font-size:200%"><b>QSO 코흐법</b></span>
    <span style="font-size:150%">&nbsp;(한글 6단계)</span>
</p>

<div class="setting">
    <span class="setting_group_2">
        <button id="play">PLAY</button>&nbsp;
        <button id="stop">STOP</button>
        </span>   

<span class="setting_group_2">
<span class="setting_bold">음색</span> <input type="number" id="freq" value="650" step="10" size="4" min="200" max="1200" /> Hz
&nbsp;
<span class="setting_bold">속도</span> <input type="number" id="speed" value="10" size="2" min="5" max="50" /> WPM
&nbsp;
<span class="setting_bold">음량</span> <input type="number" id="volume" value="100" size="3" min="1" max="100" step="1" /> %
</span>
<span class="setting_group">
<span class="setting_bold">부호간격</span> : 
<label><input type="radio" name="key" value="computer" /> 정상</label>&nbsp;
<label><input type="radio" name="key" value="space_1" /> 1></label>&nbsp;
<label><input type="radio" name="key" value="space_2" /> 2>></label>&nbsp;
<label><input type="radio" name="key" value="space_3" checked /> 3>>></label>&nbsp;
<label><input type="radio" name="key" value="space_4" /> 4>>>></label>&nbsp;
<label><input type="radio" name="key" value="space_5" /> 5>>>>></label>&nbsp;
</span>&nbsp;&nbsp;&nbsp;

<span class="setting_group">
<span class="setting_bold">글자숨기기</span> : 
<label id="selection_only" ></label>
<label id="highlight_slowly" ></label>
<label><input type="checkbox" id="hide_text" > PLAY할때</label>&nbsp;&nbsp;
<label id="repeat" ></label>
<label id="flute"></label>
<label id="noise"></label>
<label id="fading"></label>&nbsp;
</span>
</div>


<div>
<span class="sample_group">

<label id="hangul_qso_1"></label>
<label id="user_qso"></label>

</span>
</div>

<div class="log_container_ditdah"><span id="ditdah"></span></div>

<button id="sub_menu_1" style="background-color:rgb(240, 250, 200);">1 부호 ㄹ, ㅈ, ㅓ (13/2)</button>&nbsp;
<button id="sub_menu_2" style="background-color:rgb(240, 250, 200);">2 조합 (13/2)</button>&nbsp;
<button id="sub_menu_3" style="background-color:rgb(240, 250, 200);">2 단어/문장 (13/2)</button>&nbsp;


<!--  hangul_txt_1         -->
<textarea id="hangul_txt_1" rows="10">
</textarea>
<div id="hangul_txt_1_caption"></div>

<!--  user_txt         -->
<textarea id="user_txt" rows="16" class="hidden_sample">
</textarea>
<div id="user_txt_caption" class="hidden_sample">
<label><input type="radio" name="repeat_count" value="1" checked /></label>
</div>

<br>
<!--<button style="color:rgb(70, 70, 70);" onClick="location.href='/morse/koch/kor'">&nbsp;홈페이지로 돌아가기&nbsp;</button>-->
<button style="color:rgb(70, 70, 70);" onClick="window.close()">&nbsp;현재창 닫고 메뉴창으로 돌아가기&nbsp;</button>

<h3> ◆ 프로그램 정보</h3>
<span class="font_medium">
▶ 프로그램의 제작 : DS1TZE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW Trainer - <a href="https://shingiru.github.io/hangul_cw_trainer.html" target="_blank">https://shingiru.github.io/hangul_cw_trainer.html</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;한글 CW Decoder - <a href="http://shingiru.github.io/hangul_cw_decoder.html" target="_blank">http://shingiru.github.io/hangul_cw_decoder.html</a><br />
<br />
▶ QSO코흐법을 위한 재구성 : HL5KY<br />
<br>
❤ 프로그램의 사용을 허용해 주신 DS1TZE님께 감사드립니다.
<br /><br />
</span>

</div>
</body>

<!--script>Mp3LameEncoderConfig = { memoryInitializerPrefixURL: "" };</script-->
<script src="Mp3LameEncoder.min.js"></script>
<script type="text/javascript">
(function(AudioContext) {
    AudioContext.prototype.createEffect = function() {
        var bufferSize = 4096;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            const inputBuffer = e.inputBuffer;
            const outputBuffer = e.outputBuffer;

            // Loop through the output channels (in this case there is only one)
            for (let channel = 0; channel < outputBuffer.numberOfChannels; channel++) {
                const inputData = inputBuffer.getChannelData(channel);
                const outputData = outputBuffer.getChannelData(channel);

                // Loop through the 4096 samples
                for (let sample = 0; sample < inputBuffer.length; sample++) {
                    // make output equal to the same as the input
                    outputData[sample] = inputData[sample];

                    // add noise to each output sample
                    if (useNoise) outputData[sample] += ((Math.random() * 2) - 1) * 0.9; //  white noise. 0.2 noise strength 
                }
            }
        }
        return node;
    };
    
    AudioContext.prototype.createWhiteNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                output[i] = Math.random() * 2 - 1;
            }
        }
        return node;
    };

    AudioContext.prototype.createPinkNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var b0, b1, b2, b3, b4, b5, b6;
        b0 = b1 = b2 = b3 = b4 = b5 = b6 = 0.0;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                var white = Math.random() * 2 - 1;
                b0 = 0.99886 * b0 + white * 0.0555179;
                b1 = 0.99332 * b1 + white * 0.0750759;
                b2 = 0.96900 * b2 + white * 0.1538520;
                b3 = 0.86650 * b3 + white * 0.3104856;
                b4 = 0.55000 * b4 + white * 0.5329522;
                b5 = -0.7616 * b5 - white * 0.0168980;
                output[i] = b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362;
                output[i] *= 0.11; // (roughly) compensate for gain
                b6 = white * 0.115926;
            }
        }
        return node;
    };

    AudioContext.prototype.createBrownNoise = function(bufferSize) {
        bufferSize = bufferSize || 4096;
        var lastOut = 0.0;
        var node = this.createScriptProcessor(bufferSize, 1, 1);
        node.onaudioprocess = function(e) {
            var output = e.outputBuffer.getChannelData(0);
            for (var i = 0; i < bufferSize; i++) {
                var white = Math.random() * 2 - 1;
                output[i] = (lastOut + (0.02 * white)) / 1.02;
                lastOut = output[i];
                output[i] *= 3.5; // (roughly) compensate for gain
            }
        }
        return node;
    };
})(window.AudioContext);

</script>
<script type="text/javascript">
MorseNode.prototype.MORSE = {
    "A": ".-",
    "B": "-...",
    "C": "-.-.",
    "D": "-..",
    "E": ".",
    "F": "..-.",
    "G": "--.",
    "H": "....",
    "I": "..",
    "J": ".---",
    "K": "-.-",
    "L": ".-..",
    "M": "--",
    "N": "-.",
    "O": "---",
    "P": ".--.",
    "Q": "--.-",
    "R": ".-.",
    "S": "...",
    "T": "-",
    "U": "..-",
    "V": "...-",
    "W": ".--",
    "X": "-..-",
    "Y": "-.--",
    "Z": "--..",

    "1": ".----",
    "2": "..---",
    "3": "...--",
    "4": "....-",
    "5": ".....",
    "6": "-....",
    "7": "--...",
    "8": "---..",
    "9": "----.",
    "0": "-----",
    
    ".": ".-.-.-",
    ",": "--..--",
    "?": "..--..",
    "/": "-..-.",
    "+": ".-.-.",
    "-": "-....-",
    "=": "-...-",
    ":": "---...",
    ";": "-.-.-.",
    "(": "-.--.",
    ")": "-.--.-",
    "'": ".----.",
    "\"": ".-..-.",
    "@": ".--.-.",
    
    "ㄱ": ".-..",
    "ㄴ": "..-.",
    "ㄷ": "-...",
    "ㄹ": "...-",
    "ㅁ": "--",
    "ㅂ": ".--",
    "ㅅ": "--.",
    "ㅇ": "-.-",
    "ㅈ": ".--.",
    "ㅊ": "-.-.",
    "ㅋ": "-..-",
    "ㅌ": "--..",
    "ㅍ": "---",
    "ㅎ": ".---",
    "ㅏ": ".",
    "ㅑ": "..",
    "ㅓ": "-",
    "ㅕ": "...",
    "ㅗ": ".-",
    "ㅛ": "-.",
    "ㅜ": "....",
    "ㅠ": ".-.",
    "ㅡ": "-..",
    "ㅣ": "..-",
    "ㅔ": "-.--",
    "ㅐ": "--.-",
    
    // for prosign
    "&" : ".-...",
    "Ŝ" : "...-.",
    // non-standard
    "[" : "-...-.-",
    "]" : "...-.-",
    "^" : "-.-.-",
    "※" : "........"
};

MorseNode.prototype.PROSIGN = {
    "<AR>" : "+",
    "<KN>" : "(",
    "<AS>" : "&",
    "<BT>" : "=",
    "<SN>" : "Ŝ",
    // non-standard
    "<BK>" : "[",
    "<SK>" : "]",
    "<VA>" : "]",
    "<KA>" : "^",
    "<HH>" : "※"
};

function MorseNode(ac, rate) {
    // ac is an audio context.
    this._oscillator = ac.createOscillator();
    this._gain = ac.createGain();

    this._gain.gain.value = 0;
    this._oscillator.type = 'sine';
    this._oscillator.frequency.value = 600;
    
    this._oscillator.connect(this._gain);
    this.key = 'computer';

    if ("undefined" == typeof rate)
        rate = 20;
    this._dot = 1.2 / rate; // formula from Wikipedia.

    this._oscillator.start(0);
	this._moved = 0;
}

MorseNode.prototype.connect = function(target) {
    return this._gain.connect(target);
}

MorseNode.prototype.timeMove = function(sec) {
	if (ac.currentTime + this._moved + sec < queue[0][0]) sec = queue[0][0] - ac.currentTime - this._moved;
	else if (ac.currentTime + this._moved + sec > queue[queue.length - 1][0]) sec = queue[queue.length - 1][0] - ac.currentTime - this._moved;
	this._moved += sec;
	
	console.log(sec);
	
	var i = 0;
	for (; i < queue.length; i++)
		if (queue[i][0] > ac.currentTime + this._moved) break;
	
	this._gain.disconnect(filter);
	this._oscillator.disconnect(this._gain);
	this._gain = ac.createGain();
	this._gain.gain.value = 0;
	this._oscillator.connect(this._gain);
	this._gain.connect(filter);
	
	for (; i < queue.length; i++)
		this._gain.gain.setValueAtTime(queue[i][1], queue[i][0] - this._moved);
	
	var min = timestamp[0];
	timestamp.forEach((el, idx, ary) => { ary[idx] = el - sec; });
}

MorseNode.prototype.dotfac = function(t) {
    switch (this.key) {
            // t is type of dotvalue. l=letter int. i=inter el. s=spaces .=dit -=dah 
        case 'computer':
            return 1;
		case 'straightmed': //i and . are rather too long than too short, s the inverse rest is random
            if (t=='.' || t=='i') return Math.random()*0.33+0.95;
            if (t=='s') return Math.random()*0.2+0.85;
            return Math.random()*0.3+0.85;
        case 'straightbad':
            if (t=='.' || t=='i') return Math.random()*0.6+0.8;
            if (t=='s') return Math.random()*0.4+0.7;
            return Math.random()*0.5+0.75;
        case 'straightvbad':
            if (t=='.' || t=='i') return Math.random()*1.6+0.8;
            if (t=='s') return Math.random()*0.85+0.4;
            return Math.random()*0.8+0.6;
        case 'space_1':
			if (t=='s') return 1.6;
            if (t=='l') return 1.6;
        case 'space_2':
			if (t=='s') return 2.2;
            if (t=='l') return 2.2;
        case 'space_3':
			if (t=='s') return 3;
            if (t=='l') return 3;
        case 'space_4':
			if (t=='s') return 4;
            if (t=='l') return 4;            
        case 'space_5':
			if (t=='s') return 5;
            if (t=='l') return 5;            
        case 'farnsworth': //uses farnsworth
            if (t=='s') return 6;
            if (t=='l') return 4;
        case 'elmer': //uses farnsworth
            if (t=='s') return 4;
            if (t=='l') return 1.5;
            return 1;
        }

}

var smoothingDuration = 0.004;  // 10ms is very soft, icom default 4ms;
MorseNode.prototype.playChar = function(queueOnly, t, c, v) {
    for (var i = 0; i < c.length; i++) {
        switch(c[i]) {
        case '.':
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(0, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(1.0 * v, t);
			}
			enQueue(1.0 * v, t);
            t += this._dot * this.dotfac('.');
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(1.0 * v, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(0.0, t);
			}
			enQueue(0.0, t)
            break;
        case '-':
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(0, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(1.0 * v, t);
			}
			enQueue(1.0 * v, t);
            t += 3 * this._dot * this.dotfac('-');
            if (!queueOnly) {
				this._gain.gain.setValueAtTime(1.0 * v, t - smoothingDuration);
				this._gain.gain.linearRampToValueAtTime(0.0, t);
			}
			enQueue(0.0, t)
            break;
        }
        t += this._dot * this.dotfac('i');
    }
    return t;
}

var timestamp = [];
var queue = [];
function enQueue(v, t) {
	queue.push([t, v]);
}
var hasHangul = false;

MorseNode.prototype.playString = function(queueOnly, t, w, v, k, fade) {
    this.key = k;
    
    w = this.convertHangulAndProsign(w.toUpperCase());
    timestamp = [];
	queue = [];
	enQueue(0, 0);
	hasHangul = false;
    
    var start = t, fv = v;
    for (var n = 0; n < w.length; n++) {
        if (fade && (t - start) > 0) { // skip face effect during first 10s
            var pointOneSec = parseInt((t - start) * 10) % 150;
            if (pointOneSec < 75) fv = v * (100 - pointOneSec) * 0.01; // gradually goes down to the quarter volume for 7.5 sec
            else fv = v * (pointOneSec - 50) * 0.01; // gradually goes up to the normal volume for 7.5 sec
        }
        if (!highlightSlowly.checked) timestamp.push(t);
        var c = w[n];
        var hangul = (c.length > 1);
        for (var i = 0; i < c.length; i++) {
            if (c[i] == ' ' || c[i] == '\u00A0') {
                t += 4 * this._dot * this.dotfac('s'); // 3 dots gap already added after ending letter before
            }
            else if ("undefined" != typeof this.MORSE[c[i]]) {
                t = this.playChar(queueOnly, t, this.MORSE[c[i]], fv); // 1 gap after dit/dah
                t += 2 * this._dot * this.dotfac('l'); // with this 2 more gap, whole gap between letter is 3
            }
        }
        if (hangul) {
            t += (2+2) * this._dot * this.dotfac('l');
			hasHangul = true;
        }
        if (highlightSlowly.checked) timestamp.push(t);
    }
    timestamp.push(t);
    
    return t;
}

MorseNode.prototype.convertHangulAndProsign = function(w) {
    // convert prosign
    for (var key in this.PROSIGN) {
        w = w.replace(new RegExp(key.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), this.PROSIGN[key]);
    }
    return Hangul.disassemble(w, true);
}

MorseNode.prototype.getSpaceDelayInMills = function() {
    return 1000 * this._dot * (this.dotfac('i') + 2 * this.dotfac('l') + 4 * this.dotfac('s'));
}


var ac, filter, morse = null, vol = 1.0, cwPort = null, cwPortInitialized = false, cwPortOpen = false;

var ua = navigator.userAgent.toLowerCase();
var isIOS = (ua.indexOf("iphone") > -1 || ua.indexOf("ipad") > -1 || ua.indexOf("ipod") > -1);
var isAndroid = ua.indexOf("android") > -1;
var isMobile = (isIOS || isAndroid);

var freq = document.querySelector("#freq")
var wpm = document.querySelector("#speed");
var volume = document.querySelector("#volume");
var play = document.querySelector("#play");
var stop = document.querySelector("#stop");
var keyComputer = document.querySelector('input[name="key"][value="computer"]');
//var keyElmer = document.querySelector('input[name="key"][value="elmer"]');
//var keyFarnsworth = document.querySelector('input[name="key"][value="farnsworth"]');
var keySpace1 = document.querySelector('input[name="key"][value="space_1"]');
var keySpace2 = document.querySelector('input[name="key"][value="space_2"]');
var keySpace3 = document.querySelector('input[name="key"][value="space_3"]');
var keySpace4 = document.querySelector('input[name="key"][value="space_4"]');
var keySpace5 = document.querySelector('input[name="key"][value="space_5"]');
//var keyStraightMed = document.querySelector('input[name="key"][value="straightmed"]');
//var keyStraightBad = document.querySelector('input[name="key"][value="straightbad"]');
//var keyStraightVBad = document.querySelector('input[name="key"][value="straightvbad"]');
var flute = document.querySelector("#flute");
var noise = document.querySelector("#noise");
var fading = document.querySelector("#fading");
var selectionOnly = document.querySelector("#selection_only");
var highlightSlowly = document.querySelector("#highlight_slowly");
var hideText = document.querySelector("#hide_text");
var repeat = document.querySelector("#repeat");


function renewMorse() {
    ac = (ac || new AudioContext());
    if (ac.state != "running") ac.resume();

    if (morse != null) morse._oscillator.stop(0);
    morse = new MorseNode(ac, parseInt(wpm.value));
    
    filter = ac.createBiquadFilter(); 
    filter.frequency.value = freq.value;
    filter.Q.value = 0;
    
    morse.connect(filter);
    filter.connect(ac.destination);
    
    morse._dot = 1.2 / parseFloat(wpm.value);
    morse._oscillator.frequency.value = parseInt(freq.value);
}
var stopped = true, paused = false;
var cm, doc, txtValue, cursorFrom = null, cursorTo, cursorTempFrom, cursorTempTo, cursorTempEnd, highlightStart, hightlightEnd, repeatId = -1, marker = null;
var DELAY_AMOUNT = 1; // seconds
stop.onclick = function() {
    try { clearTimeout(repeatId); repeatId = -1;}
    catch (e) {}
    
    renewMorse();
    if (noiseNode) noiseGain.disconnect();
    morse.playString(false, ac.currentTime, " ", vol, document.querySelector('input[name="key"]:checked').value, fading.checked);
    doc.readOnly = false;
    
    addDitdah(false, 1); // this also manage cw port
	
	clearMarker();
	cm.setOption("extraKeys", {});
    cm.focus();
    if (cursorFrom != null) {
        doc.setSelection(cursorFrom, cursorTo);
        cm.refresh();
    }
    stopped = true;

    play.replaceChild(document.createTextNode("PLAY"), play.firstChild);
    paused = false;
}
var bufferSource = noiseNode = noiseGain = null;
play.onclick = function() {
    if (paused) {
        play.replaceChild(document.createTextNode("PAUSE"), play.firstChild);
        paused = false;
        ac.resume();
        return;
    } else if (stopped == false && repeatId == -1) {
        play.replaceChild(document.createTextNode("RESUME"), play.firstChild);
        paused = true;
        ac.suspend();
        return;
    } else {
        play.replaceChild(document.createTextNode("PAUSE"), play.firstChild);
        paused = false;
    }
    
    try { clearTimeout(repeatId); repeatId = -1;}
    catch (e) {}

    renewMorse();
    
    if (noise.checked) {
        if (bufferSource == null) {
            bufferSource = ac.createBufferSource();
            noiseNode = ac.createWhiteNoise();
            bufferSource.connect(noiseNode);
            noiseGain = ac.createGain();
            noiseNode.connect(noiseGain);
            bufferSource.start(0);
        }
        noiseGain.gain.value = vol * 0.5;
        noiseGain.connect(ac.destination);
    }
    
    clearMarker();
    cm.focus();
    if (cursorFrom != null && !stopped) {
        doc.setSelection(cursorFrom, cursorTo);
        cm.refresh();
        previousTime = 0;
    } else clearDitdah();
    
    cursorFrom = doc.getCursor("from");
    cursorTo = doc.getCursor("to");
    txtValue = doc.getSelection();
    
    var lastLine = doc.lastLine();
    var lastLineLength = doc.getLine(lastLine).length;
    
    if (selectionOnly.checked) {
        if (txtValue == '') { // when no selection  
            if (cursorTo.line == lastLine && cursorTo.ch == lastLineLength) { // when caret is at the end, start from first letter
                txtValue = doc.getValue();
                cursorTempFrom = {line: 0, ch: 0};
                cursorTempTo = {line: 0, ch: 0};
                cursorTempEnd = {line: lastLine, ch: lastLineLength};
            } else { // when caret is in the middle, start from caret position
                doc.setSelection(cursorFrom, {line: lastLine, ch: lastLineLength});
                txtValue = doc.getSelection();
                doc.setSelection(cursorFrom, cursorTo);
                cursorTempFrom = {line: cursorFrom.line, ch: cursorFrom.ch};
                cursorTempTo = {line: cursorFrom.line, ch: cursorFrom.ch};
                cursorTempEnd = {line: lastLine, ch: lastLineLength}
            }
        } else { // play selection
            cursorTempFrom = {line: cursorFrom.line, ch: cursorFrom.ch};
            cursorTempTo = {line: cursorFrom.line, ch: cursorFrom.ch};
            cursorTempEnd = {line: cursorTo.line, ch: cursorTo.ch};
        }
    } else {
        txtValue = doc.getValue();
        cursorTempFrom = {line: 0, ch: 0};
        cursorTempTo = {line: 0, ch: 0};
        cursorTempEnd = {line: lastLine, ch: lastLineLength};
    }
    highlightStart = highlightEnd = 0;
    
    morse.playString(false, ac.currentTime + DELAY_AMOUNT, 
        txtValue, 
        vol * (noise.checked ? 0.5 : 1), 
        document.querySelector('input[name="key"]:checked').value,
        fading.checked);
    
    doc.readOnly = true;

    window.localStorage.setItem('user_txt', userTxt.CodeMirror.doc.getValue());
    
    stopped = false;
    
    cm.focus();
    if (highlightSlowly.checked) doc.setSelection(cursorTempFrom, cursorTempFrom);
    if (hideText.checked) setMarker(cursorTempFrom, cursorTempEnd);
	cm.setOption("extraKeys", { Left: function() {rollback(true);}, Right: function() {rollback(false);} });
    cm.focus();
    
	/*if (selectionOnly.checked == false) repeatId = setTimeout(highlight, DELAY_AMOUNT * 1000);
    else */highlight();
}

function delayedRepeat() {
    if (!stopped) play.click();
}
var previousTime = 0;
function highlight() {
    if (timestamp.length == 0) {
        stop.click();
        if (repeat.checked) {
            stopped = false;
            repeatId = setTimeout(delayedRepeat, 2 * morse.getSpaceDelayInMills());
        }
        return;
    }
    
    if (previousTime != 0) addDitdah(morse._gain.gain.value > 0, parseInt((ac.currentTime - previousTime)*1000));
    previousTime = ac.currentTime;
    
    //if (ac.currentTime > timestamp[0]) {
    //    timestamp.shift();
    //    
    //    highlightStart = highlightEnd;
    //    cursorTempFrom.line = cursorTempTo.line, cursorTempFrom.ch = cursorTempTo.ch;
    //    
    //    if (txtValue[highlightStart] == '<' && txtValue.length > highlightStart + 3 
    //        && !!morse.PROSIGN[txtValue.substring(highlightStart, highlightStart + 4).toUpperCase()]) {
    //        highlightEnd = highlightStart + 4;
    //        cursorTempTo.ch = cursorTempFrom.ch + 4;
    //    } else if (txtValue.length > highlightStart) {
    //        highlightEnd = highlightStart + 1;
    //        if (txtValue[highlightStart] == '\n') {
    //            cursorTempTo.line++;
    //            cursorTempTo.ch = 0;
    //        } else {
    //            cursorTempTo.ch = cursorTempFrom.ch + 1;
    //        }
    //    }
    //
    //    if (!stopped && cursorTempTo.ch != 0) {
    //        cm.focus();
    //        doc.setSelection(cursorTempFrom, cursorTempTo);
    //            
    //        if (hideText.checked) {
    //            setMarker(cursorTempTo, cursorTempEnd);
    //        }
    //        
    //        cm.refresh();
    //    }
    //}
    
    if (!stopped) setTimeout(highlight, 7); // 7ms is based on the sampling rate
}
function setMarker(start, end) {
    clearMarker();
    marker = cm.markText(start, end, {className: "hide_markText"});
}
function clearMarker() {
    if (marker == null) return;
    
    marker.clear();
    marker = null;
}

function rollback(back) {
	if (stopped || morse == null) return;
	morse.timeMove(back ? -5 : 5);
}


var ditdah = document.querySelector("#ditdah");
var last = false, lastWidth = 0;
function addDitdah(bar, len) {
    if (bar == last && ditdah.childNodes.length > 0 && lastWidth < 8192) {
        var span = ditdah.lastChild;
        lastWidth += len;
        span.style.width = (parseInt(lastWidth) >> 3) + "px";
        return;
    }
    var span = document.createElement("SPAN");
    span.className = bar ? "ditdah_bar" : "ditdah_gap";  
    span.style.width = parseInt(len >> 3) + "px";
    ditdah.appendChild(span);
    if (ditdah.childNodes.length > 256) ditdah.removeChild(ditdah.firstChild);
    last = bar;
    lastWidth = len;
	
	if (cwPortOpen) cwPort.setSignals({dataTerminalReady:bar});
}
function clearDitdah() {
    var len = ditdah.childNodes.length;
    for (var i = 0; i < len; i++) ditdah.removeChild(ditdah.firstChild);
    
    previousTime = 0;
}

freq.onchange = function() {
    window.localStorage.setItem('freq', freq.value);
}
wpm.onchange = function() {
    window.localStorage.setItem('wpm', wpm.value);
}
volume.onchange = function() {
    vol = volume.value / 100.0;
    window.localStorage.setItem('volume', volume.value);
}
keyComputer.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
/*keyElmer.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keyFarnsworth.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}*/
keySpace1.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keySpace2.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keySpace3.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keySpace4.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keySpace5.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
/*keyStraightMed.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keyStraightBad.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}
keyStraightVBad.onchange = function() {
    window.localStorage.setItem('key', document.querySelector('input[name="key"]:checked').value);
}*/
flute.onchange = function() {
	smoothingDuration = flute.checked ? 0.02 : 0.004;
    window.localStorage.setItem('flute', flute.checked);
}
noise.onchange = function() {
    window.localStorage.setItem('noise', noise.checked);
}
fading.onchange = function() {
    window.localStorage.setItem('fading', fading.checked);
}
selectionOnly.onchange = function() {
    window.localStorage.setItem('selection_only', selectionOnly.checked);
}
highlightSlowly.onchange = function() {
    window.localStorage.setItem('highlight_slowly', highlightSlowly.checked);
}
hideText.onchange = function() {
    window.localStorage.setItem('hide_text', hideText.checked);
}
repeat.onchange = function() {
    window.localStorage.setItem('repeat', repeat.checked);
}
window.addEventListener('DOMContentLoaded', function() {
    try {
        if (window.localStorage.getItem('freq')) freq.value = parseInt(window.localStorage.getItem('freq'));
        if (window.localStorage.getItem('wpm')) wpm.value = parseInt(window.localStorage.getItem('wpm'));
        if (window.localStorage.getItem('volume')) volume.value = parseInt(window.localStorage.getItem('volume'));
        vol = volume.value / 100.0;
        if (window.localStorage.getItem('flute')) flute.checked = window.localStorage.getItem('flute') == 'true';
		smoothingDuration = flute.checked ? 0.02 : 0.004;
        if (window.localStorage.getItem('noise')) noise.checked = window.localStorage.getItem('noise') == 'true';
        if (window.localStorage.getItem('fading')) fading.checked = window.localStorage.getItem('fading') == 'true';
        if (window.localStorage.getItem('selection_only')) selectionOnly.checked = window.localStorage.getItem('selection_only') == 'true';
        if (window.localStorage.getItem('highlight_slowly')) highlightSlowly.checked = window.localStorage.getItem('highlight_slowly') == 'true';       
        if (window.localStorage.getItem('hide_text')) hideText.checked = window.localStorage.getItem('hide_text') == 'true';
        if (window.localStorage.getItem('repeat')) repeat.checked = window.localStorage.getItem('repeat') == 'true';
        if (window.localStorage.getItem('key')) document.querySelector('input[name="key"][value="'+window.localStorage.getItem('key')+'"]').checked = true;
        if (window.localStorage.getItem('user_txt')) userTxt.CodeMirror.doc.setValue(window.localStorage.getItem('user_txt'));
        if (window.localStorage.getItem('qso_sample')) changeQsoSample(window.localStorage.getItem('qso_sample'));
        else changeQsoSample("hangul_txt_1");
		if (!isAndroid && !isIOS) document.querySelector("#keyer_setting").style.display = "inline";
    } catch (e) {
    }
}, true);

function makeEditor(textArea, display) {
    var editor = CodeMirror(function(el) {
        el.id = textArea.id;
        el.className = el.className + " " + textArea.className;
        textArea.parentNode.replaceChild(el, textArea);
    }, {value: textArea.value, mode: "xml", lineWrapping: true, styleSelectedText: true
		//, extraKeys: { Left: function() {rollback(true);}, Right: function() {rollback(false);} }
	});
}

makeEditor(document.querySelector("#hangul_txt_1"));
makeEditor(document.querySelector("#user_txt"));

var txt = document.querySelector("#hangul_txt_1");
var userTxt = document.querySelector("#user_txt");

var hangulQso1 = document.querySelector("#hangul_qso_1");
var userQso = document.querySelector("#user_qso");

var SubMenu1 = document.querySelector("#sub_menu_1");
var SubMenu2 = document.querySelector("#sub_menu_2");
var SubMenu3 = document.querySelector("#sub_menu_3");
var SubMenu4 = document.querySelector("#sub_menu_4");
var SubMenu5 = document.querySelector("#sub_menu_5");
var SubMenu6 = document.querySelector("#sub_menu_6");
//var randomSB = document.querySelector("#sub_menu_4");

function changeQsoSample(newTxtId) {
    var newTxt = document.querySelector("#" + newTxtId);
    //if (txt == newTxt) return;

    var txtCaption = document.querySelector("#" + txt.id + "_caption");
    var newTxtCaption = document.querySelector("#" + newTxtId + "_caption");
    if (!txtCaption || !newTxtCaption) return;
    
    if (!stopped) stop.click();
    cursorFrom = null;
    
    txt.style.display = "none";
    txtCaption.style.display = "none";
    
    txt = newTxt;
    txtCaption = newTxtCaption;
    
    txt.style.display = "block";
    txtCaption.style.display = "block";
    
    txt.classList.toggle('active');
    cm = txt.CodeMirror;
    doc = cm.doc;
    cm.refresh();

    window.localStorage.setItem('qso_sample', newTxtId);
    window.localStorage.setItem('user_txt', userTxt.CodeMirror.doc.getValue());
}
hangulQso1.onclick = function() {
    changeQsoSample("hangul_txt_1");
}
userQso.onclick = function() {
    changeQsoSample("user_txt");
}

function getRepeatCount() {
    return parseInt(document.querySelector('input[name="repeat_count"]:checked').value);
}

//<span class="setting_bold">속도</span> <input type="number" id="speed" value="20" size="2" min="5" max="50" /> WPM

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
    return ELEMENTS[j];
}
}

SubMenu1.onclick = function() {
    stop.click();

    var repeatedWORDS = [];
    var addedWORDS = ["ㄹ","ㄹ","ㄹ","ㅈ","ㅈ","ㅈ","ㅓ","ㅓ","ㅓ","ㄹ","ㄹ","ㅈ","ㅈ","ㅓ","ㅓ"];
    repeatCount = getRepeatCount();

    var WORDS = [
    "ㄹ ㅈ ㅓ"
    ];

    loopCount = 18
    for (var n = 0; n < loopCount; n++) {
        for (repeatedWORDS of WORDS)
        addedWORDS.push(Array(repeatCount).fill(repeatedWORDS).join(""));
    }

    doc.setValue(addedWORDS.join(" ")
    //+ "\n" 
    //+ "                                                                                                         \n"
    //+ "\n"     
    //+ "\n"
    );
}


SubMenu2.onclick = function() {
    stop.click();

    var slicedWORDS = [];
    var repeatedWORDS = [];
    var addedWORDS = [];
    repeatCount = getRepeatCount();

    var WORDS = [
    "라","락","란","랄","랍",
    "랏","랑","랐","러","럭",
    "런","럴","럽","럿","렁",
    "렇","로","록","론","롤",
    "롭","롯","롱","료","룡",
    "르","륵","른","를","릅",
    "릇","릉","리","릭","린",
    "릴","립","릿","링","래",
    "랙","랜","랠","랩","랫",
    "랭","레","렉","렌","렐",
    "렙","렛","렝","자","작",
    "잔","잘","잡","잣","장",
    "잦","잧","잖","저","적","전",
    "젇","절","접","젓","정",
    "젖","젗","젔","조","족",
    "존","졸","좁","종","좋",
    "죠","죤","즈","즉","즌",
    "즐","즙","즛","증","지",
    "직","진","질","집","짓",
    "징","짖","짛","재","잭",
    "잰","잴","잽","잿","쟁",
    "제","젝","젠","젤","젭",
    "젯","젱","짜","짝","짠",
    "짤","짭","짯","짱","짞",
    "짰","짧","쩌","쩍","쩐",
    "쩔","쩝","쩟","쩡","쪼",
    "쪽","쫀","쫄","쫍","쫑",
    "쩌","쩍","쩔","쩝","쩟",
    "쩡","쪼","쪽","쫀","쫄",
    "쫍","쫑","쯔","쯥","쯩",
    "찌","찍","찐","찔","찝",
    "찟","찡","찎","째","짹",
    "짼","쨀","쨉","쨋","쨍",
    "쩨","쩩","쩬","쩰","쩹",
    "쩽","거","걱","건","걷",
    "걸","겁","것","겅","겆",
    "겇","겄","꺼","꺽","껀",
    "껃","껄","껍","껏","껑",
    "꺾","너","넉","넏","널",
    "넙","넛","넝","넞","넣",
    "넓","넋","더","덕","던",
    "덜","덥","덧","덩","덪",
    "덫","덯","덖","덟","떠",
    "떡","떤","떨","떱","떳",
    "떵","떻","러","럭","런",
    "럴","럽","럿","렁","렇",
    "버","벅","번","벋","벌",
    "법","벗","벙","벚","벛",
    "벆","벘","뻐","뻑","뻔",
    "뻗","뻘","뻡","뻣","뻥",
    "서","석","선","섣","설",
    "섭","섯","성","섲","섳",
    "섞","섰","써","썩","썬",
    "썰","썹","썻","썽","썼",
    "썪","어","억","언","얻",
    "얼","업","엇","엉","엊",
    "엋","얹","었","저","적",
    "전","절","접","젓","정",
    "젔","처","척","천","철",
    "첩","첫","청","첬","허",
    "헉","헌","헐","헙","헛",
    "헝","헞","갉","긁","낡",
    "늙","밝","앓","닳","핧",
    "밟","옳",
    ];

    loopCount = 1
    for (var n = 0; n < loopCount; n++) {
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        for (repeatedWORDS of WORDS)
        addedWORDS.push(Array(repeatCount).fill(repeatedWORDS).join(""));
    }

    FinalSliceNumber = 35
    slicedWORDS = addedWORDS.slice(0, FinalSliceNumber);
    doc.setValue(slicedWORDS.join("  ")
    //+ "                                                                                                         \n"
    //+ "\n"     
    //+ "- 새로운 형식\n"
    //+ "DE 호출부호 73<SK>EE\n"
    );  
     
}


SubMenu3.onclick = function() {
    stop.click();

    var slicedWORDS = [];
    var repeatedWORDS = [];
    var addedWORDS = [];
    repeatCount = getRepeatCount();

    var WORDS = [
    "또 다시 교신합시다.","이곳의 날씨는 흐립니다,","기온은 15도 정도입니다.",
    "이곳에는 비가 오고 있습니다.","교신은 언제나 환영입니다.","대단히 반갑습니다.","오늘도 즐거운 교신이었습니다.",
    "언제나 환영합니다.","긴 교신을 하고 뻗었다,","교신을 길게 하지 않습니다.","교신은 짧게 합니다,",
    "디엑스는 대개 짧은 교신,","전신교신의 즐거움은?","즐거운 교신을 합니다.","교신은 언제나 즐깁니다,",
    "새장비는 설치했습니까?","아니오 아직입니다,","뻥이 대단하시네요,","왜요 섭섭합니까?","아니오 그렇지는 않지요,",
    "종종 찾아주세요,","교신 기대하겠습니다.","교신은 종종 합니다,","끊이지 않고 찾아옵니다.","작정하고 시작해라,",
    "항상 깨끗이 사용하세요.","정도가 있지 과하십니다.","아주 인생이 꼬입니다,","디엑스와 건강,","작정하고 찍어라.",
    "디엑스는 건강에 나빠요.","인생이 교신인 인간,","흐린 날씨에도 대단하네,","바닷가에서의 교신,",
    "비오는 날에는 교신,","전신이 그렇긴하죠,","제가 함께 가도 될까요?","옥상에 설치합니다.","전신을 전선으로,",
    "장비는 좋지 않아요,","항상 로시가 좋아요,","송신이 나쁘지는 않아요,","오늘은 기온이 낮아요,",
    "온도는 7도 정도입니다.","교신 내용은 뻔하죠.","교신의 반은 뻥이죠.","디엑스도 뻥일때가 있죠.",
    "그래도 전신은 즐겁습니다.","왜요 송신이 나빠요?","그런대로 들을 정도입니다.","억지로 하면 안돼요.",
    "차근차근 설치하세요,","교신을 할때는 바빠요,","송신은 정신 없어요.","그렇잖아도 갈 참이에요.",
    "이래도 교신합니까?","이런 날에는 전신이 딱이죠,","사나이가 절절매다니,","자라가 절룩거리네,",
    "건강을 헤치면 나빠요.","낯에는 디엑스가 좋지 않아요.","이곳은 거제입니다.",
    "거창에도 설비가 있나요?","장비는 거치식인가요?","아니오 이동용입니다.","이동운용의 재미,","새가 짹짹거린다.",
    "가을에는 이동운용,","밖에서의 운용이 기대된다.","정동진에 배가 없다고요?",
    "그럴리가 없는데,","어떻게 이런 일이,","이렇게 늦은 시간에,","가는 날이 장날이라더니,","언쟁이 싫어요,",
    "다 그런거죠,","그래도 그렇지 안돼요,","밖을 내다 보세요,","아직 하늘에 해가 있는데,","하늘을 보고 빕니다.",
    "어떻게 해도 할일이니까요,","벗이 찾아와도 좋고,","언제나 즐겁죠.","제대로 교신 한번 하자.",
    "전신학습 하고 있나요?","제대로 연습하세요.","정신 차리고 하세요,","전신을 한다고요,","이것도 연습입니까?",
    "이번해는 그렇잖아요,","교신은 어떻습니까?","기대한대로 되었나요?","아니오 기대치와 달라요.","기회를 노리세요.",
    "기회는 종종 옵니다,","제도가 제대로 돼야,","아주 잘 보이네,","좌측방에 비행기,","갈지자로 걷는 게,",
    "거대한 설비가 거창에,","한다고 한것이 이겁니까?","어떻게 이것밖에 없나요?","밖에 나가서 사세요.",
    "교신은 밖에서 해야죠.","아니요 교신은 실내에서,","비가 오는데 실내로 들어와,","저의 신호가 좋지 않나요?",
    "강도가 세도 잘 못 듣네,","집에 강도가 들었어요.","대단히 뻔뻔하시네요,","어쩔수가 없었다.","교신도 호작질?",
    "이러지도 저러지도,","이리도 내속을 긁어놓다니,","아주 화가 났네요.","회신이 없으니 걱정이다.",
    "회로가 고장났나봐,","화랑이 화살을 쏘다.","언제적 뻥이냐,","뻥도 대단해라,","뻥과자를 좋아해,",
    "그대를 좋아해,","벛꽃이 보이기 시작,","곧 개나리의 개화시기,","따뜻할때 꽃이 한창,","다들 어디 갔나요?",
    "이쪽으로 와봐요,","당근에서 샀나요?","당근 당근에서 사야죠.","당근을 채썰다.","아리랑 교신,",
    "좋아요 아라리요,","이것은 어떨까요?","다시는 교신 안합니다.","왜 교신을 안해요?","전신이라도 하시죠.",
    "이런 기회가 또 오지는 않아요.","디엑스 하기 딱 좋아요.","이런 날은 디엑스죠.","비도 오는데 전신이라도,",
    "전선을 설치하세요,","다시 전선을 깔아라,","아버지께서 교신을,","장비는 아버지께 드린다.","적적할때 호작질,",
    "나도 전선을 설치했다.","복잡하다 저리가라.","저런 인간이 어디있나,","이제는 너도 가자.","잘 한다 철도 없이,",
    "고기도 잡고 놀자,","러시아는 교신이 잘돼,","너는 롱런하겠다.",
    "항상 정리를 잘 해야돼,","호러는 싫다.","호랑이를 봤다고?","호작질 그만해라.","전신은 호작질이 아니다.",
    "낙동강 전선,","대동강 삿갓은?","시방 한글 연습,","한글 전신은 좋아,","한글로 전신을 한다꼬?","그게 제정신이냐?",
    "네가 좋다니 됐지,","지도의 가로가 길다.","간다고 해 놓고서는,","서로 좋다니 어쩌지,","반찬이 아주 짜네,",
    "그 인간 아주 짜네,","완전히 짠돌이네,","180도 반대네,","아이 셋을 낳고는,","이방은 질이 나빠,",
    "시골에서 소똥을 밟았다.","이리저리 발에 채인다.","밟히는게 쇠똥이네,","인간들이 득실득실,","기와가 바닥에 떨어지다.",
    "황제라도 밥은 세끼,","제발 정신차리세요.","제 자신을 안다,","연습은 착실히,","착하게 살아라,","종종 학교에 가다.",
    "학교는 가끔 가는 곳,","제자리에서 달리기,","그래도 꽃이 좋아,","너 자신을 사랑해라,","사랑은 세상을 살린다.",
    "교신은 사랑이다,","이러는 동안 가겠다.","더러 자신을 속이지,","교신이 그립다,",
    "세상과는 단절,","사바세계에 떨어진 인간,","밖에서 쓰러지다.","어쩔수 없다.","전신을 착실히 학습,",
    "교신은 베란다에서,","베란다의 차가움,","언제나 갈등이다,","제발 이렇게 해요,","제발 전신을 하세요,",
    "제발 저린 강도,","복날에 개가 어디에,","인자한 아버지,","널찍한 베란다에서,","당신도 전선을 잡아라,",
    "전선을 꼭 잡고 있어,","어디 가더라도 내 생각해,","사랑스런 아이,","자랑스러운 교신,","비에 다 젖었네,",
    "비에 젖어도 꽃은,","젖지 않는 바다,","젖은 옷을 입어라,","비내리는 호남선,","거리에서 교신을,",
    "오늘은 홀로 있다.","홀로 지내는 세월,","오늘은 비가 내리네,","걷는 지각대장,","자리돔이 비싸네,",
    "저라도 갈까요?","저더러 가자고 하네요.","조용히 자고 있네,","용을 쓴다고 되는 건 아니다.","적적하니 전신을,",
    "천천히 해라,","천사라도 화가 난다.","강가에 들꽃이,","천번을 생각해도,","덩그러니 혼자 서 있다.",
    "혼자 덩그러니 앉았다.","넓은 공간에 혼자,","쓸쓸히 홀로 서서,","공간이 비어서 쓸쓸해,","실내가 꽤 넓네,",
    "밖에 혼자 덩그러니,","거리가 넓다.","어디라도 가보자,","넓은 공간이 싫다.","이렇게라도 해야지,",
    "걸어서 가는 거리,","절대로 학교는 안가,","절로 신이 난다.","저는 절에 다닙니다.","조용한 절간에서 산다.",
    "혼자 조용히 와라,","간다고 될 일이 아니다.","건강이 좋아야 된다.","건대는 가깝지 않다.","사실 이제는 조용히 산다.",
    "나도 내 생활을 한다.","광활한 대지에 꽃 한송이,","곽씨가 걱정이다.","시간이 걸리는 일,","아직 소식이 없네,",
    "또 다시 나오십니까?","서로 동의된 일,","또 이런걸 사오시다니,","꽃이 이렇게 곱습니다.","거지가 다가오네,",
    "어떤 것을 좋아하니?","소리도 없이 다가오다.","싸가지없는 인간,","송신기에서 소리가 나네,","신호가 하늘로 날아간다.",
    "장비전시회에 간다.","전신에 전전긍긍,","사진을 올리세요,","길조 소리가 나네,","바닥까지 닦아라,","종이에 빽빽하게 쓰다.",
    "갑자기 전화를 끊다.","급하게 어딜 가니?","급전을 빌린다고","급전의 이자가 대박,","시골의 대박사건,",
    "호박이 과자된다.","과거지사는 잊어라,","한자의 의미를 안다.","이미 지나간 때의 일,","사자성어를 읽어라,",
    "읽지도 않고 간다고,","어찌하나요 어찌할까요?","나쁜 신호로 교신,","대가리가 없는 고기,","혼자서 서럽게시리,",
    "시럽을 넣을까요?","화살이 너희쪽으로,","희소식은 꽃이 되어,","절로 신나는 교신,","왠지 나를 그런쪽에,",
    "어쩌다가 헤어지다.","그렇게도 그대에게 사랑을,","살생은 절대 안돼,","절에는 노이즈가 없을까?",
    "도시에는 항상 노이즈가,","조용한 절에도 노이즈가,","강한 노이즈로 인해,","알고 있는게 다가 아니다.",
    "러시아로 이동운용,","활발하게 운용,","교신은 조용히 해라.","전신은 조용한 교신.","아주 신났네,",
    "저절로 이동한다.","강제로 제어한다.","운용을 강제로 저지.","성질 나쁜 인간,","화를 안내고 참자,",
    "화를 입을까 겁난다.","화촉을 밝히다의 뜻은?.","촛농이 떨어지다.","용빼는 방법이 있나?",
    "헛것을 보고 달린다.","화재로 재산을 날리다.","재화는 개인의 자유다.","더 이상 잃을게 없다.","전쟁이 이제 정전,",
    "전건을 어떻게 사지?","전건이 없어도 돼.","좋은 전건이 있다.","혼자서는 재간이 없다.","사실 전건이 없어졌다.",
    "전라도에 전화해라.","저는 전라도에 삽니다.","집에 장식장이 있다.",
    "어찌할 도리가 없다.","도리도리 짝짜꿍,","조찬회의에 나오세요?","글쎄 어떨지 알수 없네요.","글썽글썽합니다.",
    "갈수 없을지도,","잘 알아서 해라.","그래 일은 네가 해라.","나는 알수 없어,","될대로 되라지,",
    "한번 본다고 알수 있나,","그러게 게으른 인간아,","일찍 간다고 되니?","일찍 서둘러라.","찌질한 인간아,",
    "생활이 찌들었네,","교신은 랄랄라,","나는 날라리 신자.","달에 도착했다고?","초승달이 이쁘네,",
    "때로는 전신도 해야죠,","때때로 지각해요,","화살이 홱 지나갔네,","실내를 확장하자,","돼지에게 찬밥을,",
    "꼭두각시 노릇도 이제,","노릇노릇 잘 됐네,","이제 학교가자.","학생이 소주를,","설비가 대박이다.",
    "슬슬 일어납시다.","생활이 착실해요,","작작 징징대라,","에이 이걸 가지고,","애인도 없니?","작작 떠들어,",
    "삶이 괴롭다고?","그렇다고 전선을 잘라?","언젠가는 씹을거다,","잘근잘근 씹어서,","네도 길치지?",
    "난 길을 잘 찾아,","어느길로 갈까?","아빠 찾아 십리,","라일락 꽃이 보인다.","엘도라도로 돌아가자,",
    "나도 엘리제가 좋아,","얼씨구 절씨구,","얼싸안고 좋아하네,","악바리 인간,","바리바리 싸들고,",
    "바들바들 떨고있다.","네 하나 건사하기도,","서로 어깨가 부딪히다.","그렇다고 꾸짖어요?","작전회의를 전달,",
    "설레발이 대단하네,","어처구니가 없어서,","그래서 어쩔건데?","어디 갈데라도 있니?","엘리제는 어디있어?",
    "똑바로 대답안해?","로구로의 뜻을 알아?","오랑대가 어디있지?","오랑대는 송정에 있지,","시랑대는 어디있지?",
    "시랑대도 송정에,","그래서 오시리아라고 해,","오시리아의 뜻은?","인간이 갈지자로 걷네,","어디가 엘도라도지?",
    "저쪽에 엘도라도가 보인다.","그쪽에서 교신해,","신호가 잘 들어오네,","바닷가는 신호가 좋아,","작정하고 나가라,",
    "디엑스도 잘 되겠네,","글쎄 교신이 잘 될까?","초란이 그렇게 좋다는데,","그런뜻인지 알수 없다.","전기신호가 작네,",
    "왜 자라보고 놀란다고?","전체가 전전긍긍","강진은 전라도에 있다.","거지로 전락하다.","전장에서 어디로?",
    "잘 보고 장전하세요,","절간에 정적이 흐르네,","적장은 적이다.","반찬이 질린다.","정전되어도 교신,",
    "적어서 보관해요.","장전하고 쏘세요.","작천정에 왠 라일락이,","기회가 오니 작전개시,","넓어서 널찍하네,",
    "빨리 전건을 치세요.","전건 에러를 적게해야,","전신은 정확성,","확정이 되고 송신,","정식으로 교신한다.",
    "정적이 흘러요,","절간에 정적이,","전선에 정적이,","총소리가 없으니 정적이,","청산가리는 안돼,",
    "천한 인간이 어디있어?","절로 흥이 난다.","교신은 절로 신나.","전신에 절절매다.","전건이 절룩절룩,",
    "허리가 잘록하네,","잘록한 청자,","절절매는 교신,","구구절절 옳다.","자리를 옮기는게 나아,",
    

    ];

    loopCount = 1
    for (var n = 0; n < loopCount; n++) {
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        WORDS.sort(() => Math.random() - 0.5);
        for (repeatedWORDS of WORDS)
        addedWORDS.push(Array(repeatCount).fill(repeatedWORDS).join(""));
    }

    FinalSliceNumber = 9
    slicedWORDS = addedWORDS.slice(0, FinalSliceNumber);
    doc.setValue(slicedWORDS.join("  ")
    //+ "                                                                                                         \n"
    //+ "\n"     
    //+ "- 새로운 형식\n"
    //+ "DE 호출부호 73<SK>EE\n"
    );  
     
}

</script>
</html>
